(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{10:function(e,t,a){"use strict";a.d(t,"a",function(){return i});var n=a(7);function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function i(e,t){var a=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},{credentials:"include",headers:new Headers({"Content-Type":"application/json"})},{},t);return fetch(e,a).then(function(e){var t=e.status,a=e.msg;if(t>=200&&t<300)return e;var n=new Error(a);throw n.status=t,n.response=e,n}).then(function(e){return e.json()}).catch(function(e){console.log("\u7f51\u7edc\u8bf7\u6c42\u5931\u8d25\uff01")})}},16:function(e,t,a){},18:function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=a(1),c=a.n(i),s=a(3),l=a.n(s),o=(a(22),a(24),Object(n.memo)(function(e){var t=e.date,a=e.onClickPre,i=e.onClickNext,s=e.isPreDisabled,o=e.isNextDisabled,u=Object(n.useMemo)(function(){var e=l()(t);return e.format("M\u6708D\u65e5")+e.locale("zh-cn").format("ddd")},[t]);return r.a.createElement("div",{className:"nav"},r.a.createElement("span",{className:c()("nav-prev",{"nav-disabled":s}),onClick:a},"\u524d\u4e00\u5929"),r.a.createElement("span",{className:"nav-current"},u),r.a.createElement("span",{className:c()("nav-next",{"nav-disabled":o}),onClick:i},"\u540e\u4e00\u5929"))}));t.a=o},19:function(e,t,a){"use strict";a.d(t,"a",function(){return i});var n=a(0),r=a(2);function i(e,t,a){var i=Object(r.a)(e)<=Object(r.a)(),c=Object(r.a)(e)-Object(r.a)()>1728e6,s=Object(n.useCallback)(function(){i||t()},[i,t]),l=Object(n.useCallback)(function(){c||a()},[c,a]);return{isPreDisabled:i,isNextDisabled:c,onClickPre:s,onClickNext:l}}},2:function(e,t,a){"use strict";function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=new Date(e);return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t.getTime()}a.d(t,"a",function(){return n})},20:function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=a(3),c=a.n(i);a(22),a(25);function s(e){var t=c()(e);return"".concat(t.format("MM-DD")," ").concat(t.locale("zh-cn").format("ddd"))}var l=Object(n.memo)(function(e){var t=e.departDate,a=e.arriveDate,i=e.departTimeStr,c=e.arriveTimeStr,l=e.departStation,o=e.arriveStation,u=e.trainNumber,d=e.durationStr,m=Object(n.useMemo)(function(){return s(t)},[t]),p=Object(n.useMemo)(function(){return s(a)},[a]);return r.a.createElement("div",{className:"detail"},r.a.createElement("div",{className:"content"},r.a.createElement("div",{className:"left"},r.a.createElement("p",{className:"city"},l),r.a.createElement("p",{className:"time"},i),r.a.createElement("p",{className:"date"},m)),r.a.createElement("div",{className:"middle"},r.a.createElement("p",{className:"train-name"},u),r.a.createElement("p",{className:"train-mid"},e.children),r.a.createElement("p",{className:"train-time"},"\u8017\u65f6",d)),r.a.createElement("div",{className:"right"},r.a.createElement("p",{className:"city"},o),r.a.createElement("p",{className:"time"},c),r.a.createElement("p",{className:"date"},p))))});t.a=l},24:function(e,t,a){},25:function(e,t,a){},73:function(e,t,a){e.exports=a(80)},74:function(e,t,a){},75:function(e,t,a){},76:function(e,t,a){},80:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(11),c=a.n(i),s=a(6),l=(a(21),a(5)),o=a(10),u=a(13),d="ACTION_SET_DEPARTDATE",m="ACTION_SET_ARRIVEDATE",p="ACTION_SET_DEPARTTIMESTR",f="ACTION_SET_ARRIVETIMESTR",v="ACTION_SET_DEPARTSTATION",S="ACTION_SET_ARRIVESTATION",b="ACTION_SET_TRAINNUMBER",h="ACTION_SET_DURATIONSTR",E="ACTION_SET_TICKETS",N="ACTION_SET_ISSCHEDULEVISIBLE",y="ACTION_SET_SEARCHPARSED";function O(e){return{type:d,payload:e}}function D(e){return{type:m,payload:e}}function T(e){return{type:p,payload:e}}function g(e){return{type:f,payload:e}}function j(e){return{type:h,payload:e}}function w(e){return{type:E,payload:e}}function k(e){return{type:N,payload:e}}var A={departDate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case d:return n;default:return e}},arriveDate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case m:return n;default:return e}},departTimeStr:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case p:return n;default:return e}},arriveTimeStr:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case f:return n;default:return e}},departStation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case v:return n;default:return e}},arriveStation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case S:return n;default:return e}},trainNumber:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case b:return n;default:return e}},durationStr:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case h:return n;default:return e}},tickets:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case E:return n;default:return e}},isScheduleVisible:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case N:return n;default:return e}},searchParsed:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case y:return n;default:return e}}},C=a(15),I=Object(l.d)(Object(l.c)(A),{departDate:Date.now(),arriveDate:Date.now(),departTimeStr:null,arriveTimeStr:null,departStation:null,arriveStation:null,trainNumber:null,durationStr:null,tickets:[],isScheduleVisible:!1,searchParsed:!1},Object(l.a)(C.a)),P=(a(74),a(12)),_=a.n(P),x=a(3),M=a.n(x),R=a(9),V=a(18),Y=a(2),B=a(19),H=a(20),z=a(4),L=(a(75),Object(n.createContext)()),U=Object(n.memo)(function(e){var t=e.name,a=e.desc,i=e.type,c=Object(n.useContext)(L),s=c.trainNumber,l=c.departStation,o=c.arriveStation,u=c.departDate,d=Object(n.useMemo)(function(){return new _.a("order.html").search({trainNumber:s,departStation:l,arriveStation:o,departDate:M()(u).format("YYYY-MM-DD"),type:i}).toString()},[o,u,l,s,i]);return r.a.createElement("div",{className:"channel"},r.a.createElement("div",{className:"middle"},r.a.createElement("div",{className:"name"},t),r.a.createElement("div",{className:"desc"},a)),r.a.createElement("a",{href:d,className:"buy-wrapper"},r.a.createElement("div",{className:"buy"},"\u4e70\u7968")))}),J=Object(n.memo)(function(e){var t=e.type,a=e.priceMsg,n=e.ticketsLeft,i=e.channels,c=e.expanded,s=e.onToggle,l=e.idx;return r.a.createElement("li",null,r.a.createElement("div",{className:"bar",onClick:function(){s(l)}},r.a.createElement("span",{className:"seat"},t),r.a.createElement("span",{className:"price"},r.a.createElement("i",null,"\uffe5"),a),r.a.createElement("span",{className:"btn"},c?"\u6536\u8d77":"\u9884\u8ba2"),r.a.createElement("span",{className:"num"},n)),r.a.createElement("div",{className:"channels",style:{height:c?55*i.length+"px":0}},i.map(function(e){return r.a.createElement(U,Object.assign({key:e.name},e,{type:t}))})))}),K=Object(n.memo)(function(e){var t=e.tickets,a=Object(n.useState)(0),i=Object(z.a)(a,2),c=i[0],s=i[1],l=Object(n.useCallback)(function(e){s(e===c?-1:e)},[c]);return r.a.createElement("div",{className:"candidate"},r.a.createElement("ul",null,t.map(function(e,t){return r.a.createElement(J,Object.assign({idx:t,expanded:c===t,key:e.type},e,{onToggle:l}))})))}),Q=(a(76),Object(n.lazy)(function(){return a.e(10).then(a.bind(null,82))}));var W=Object(s.b)(function(e){return e},{setDepartDate:O,setArriveDate:D,setDepartTimeStr:T,setArriveTimeStr:g,setDepartStation:function(e){return{type:v,payload:e}},setArriveStation:function(e){return{type:S,payload:e}},setTrainNumber:function(e){return{type:b,payload:e}},setDurationStr:j,setTickets:w,setIsScheduleVisible:k,toggleIsScheduleVisible:function(){return function(e,t){e(k(!t().isScheduleVisible))}},setSearchParsed:function(e){return{type:y,payload:e}},setNextDay:function(){return function(e,t){e(O(t().departDate+864e5))}},setPrevDay:function(){return function(e,t){e(O(t().departDate-864e5))}},fetchTickets:function(e){return function(t,a){Object(o.a)("".concat("https://www.fastmock.site/mock/36f5aae2666808101e4821ce39e2a27c","/rest/ticket?").concat(Object(u.stringify)(e))).then(function(e){var a=e.data,n=a.detail,r=a.candidates,i=n.departTimeStr,c=n.arriveTimeStr,s=n.arriveDate,l=n.durationStr;t(T(i)),t(g(c)),t(D(s)),t(j(l)),t(w(r))})}},fetchSchedule:function(e,t){return function(){Object(o.a)("".concat("https://www.fastmock.site/mock/36f5aae2666808101e4821ce39e2a27c","/rest/schedule?").concat(Object(u.stringify)(e))).then(function(a){for(var n,r=a.data,i=e.departStation,c=e.arriveStation,s=0,l=r.length;s<l;++s)n?r[s].station===c?n=Object.assign(r[s],{beforeDeaprtStation:!1,isDepartStation:!1,afterArriveStation:!1,isArriveStation:!0}):Object.assign(r[s],{beforeDeaprtStation:!1,isDepartStation:!1,afterArriveStation:!0,isArriveStation:!1}):r[s].station===i?n=Object.assign(r[s],{beforeDeaprtStation:!1,isDepartStation:!0,afterArriveStation:!1,isArriveStation:!1}):Object.assign(r[s],{beforeDeaprtStation:!0,isDepartStation:!1,afterArriveStation:!1,isArriveStation:!1}),Object.assign(r[s],{isStartStation:0===s,isEndStation:s===r.length-1});t&&t(r)})}}})(function(e){var t=e.departDate,a=e.arriveDate,i=e.departTimeStr,c=e.arriveTimeStr,s=e.departStation,l=e.arriveStation,o=e.trainNumber,u=e.durationStr,d=e.tickets,m=e.isScheduleVisible,p=e.setArriveStation,f=e.setDepartStation,v=e.setTrainNumber,S=e.setDepartDate,b=e.searchParsed,h=e.setSearchParsed,E=e.setNextDay,N=e.setPrevDay,y=e.fetchTickets,O=e.toggleIsScheduleVisible,D=e.fetchSchedule;Object(n.useEffect)(function(){var e=_.a.parseQuery(window.location.search),t=e.aStation,a=e.dStation,n=e.date,r=e.trainNumber;p(t),f(a),v(r),S(Object(Y.a)(M()(n).valueOf())),h(!0)},[p,S,f,h,v]);var T=Object(n.useCallback)(function(){window.history.back()},[]);Object(n.useEffect)(function(){document.title=o},[o]);var g=Object(B.a)(t,N,E),j=g.isPreDisabled,w=g.isNextDisabled,k=g.onClickPre,A=g.onClickNext;return Object(n.useEffect)(function(){y({date:M()(t).format("YYYY-MM-DD"),trainNumber:o})},[t,y,o]),b?r.a.createElement("div",{className:"app"},r.a.createElement("div",{className:"header-wrapper"},r.a.createElement(R.a,{title:o,onBack:T})),r.a.createElement("div",{className:"nav-wrapper"},r.a.createElement(V.a,{date:t,isPreDisabled:j,isNextDisabled:w,onClickPre:k,onClickNext:A})),r.a.createElement("div",{className:"detail-wrapper"},r.a.createElement(H.a,{departDate:t,arriveDate:a,departTimeStr:i,arriveTimeStr:c,departStation:s,arriveStation:l,trainNumber:o,durationStr:u},r.a.createElement("span",{className:"left"}),r.a.createElement("span",{className:"schedule",onClick:function(){return O()}},"\u65f6\u523b\u8868"),r.a.createElement("span",{className:"right"}))),r.a.createElement(L.Provider,{value:{trainNumber:o,departStation:s,arriveStation:l,departDate:t}},r.a.createElement(K,{tickets:d})),m?r.a.createElement("div",{className:"mask",onClick:function(){return O()}},r.a.createElement(n.Suspense,{fallback:r.a.createElement("div",null,"\u7ec4\u4ef6\u52a8\u6001\u52a0\u8f7d\u4e2d\u2026\u2026")},r.a.createElement(Q,{date:t,trainNumber:o,departStation:s,arriveStation:l,fetchSchedule:D}))):null):null});c.a.render(r.a.createElement(s.a,{store:I},r.a.createElement(W,null)),document.getElementById("root"))},9:function(e,t,a){"use strict";a.d(t,"a",function(){return i});var n=a(0),r=a.n(n);a(16);function i(e){var t=e.onBack,a=e.title;return r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"header-back",onClick:t},r.a.createElement("svg",{width:"42",height:"42"},r.a.createElement("polyline",{points:"25,13 16,21 25,29",stroke:"#fff",strokeWidth:"2",fill:"none"}))),r.a.createElement("h1",{className:"header-title"},a))}}},[[73,8,0,1]]]);
//# sourceMappingURL=ticket.728b2ea8.chunk.js.map